<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Phenological phase — phenoPhase • wql</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>
  
  
<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">wql</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="..//index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/wql-package.html">wql: Exploring water quality monitoring data</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/jsta/wql">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Phenological phase</h1>
    </div>

    
    <p>Finds various measures of the phase of the annual cycle, or of some
specified month range.</p>
    

    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>A seasonal time series, or a class <code>zoo</code> object.</p></td>
    </tr>
    <tr>
      <th>season.range</th>
      <td><p>A vector of two numbers specifying the season range to
be considered.</p></td>
    </tr>
    <tr>
      <th>out</th>
      <td><p>The form of the output.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Additional arguments to be passed for changing integration
defaults.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A data frame with columns year, time of the maximum, fulcrum,
weighted mean time and -- in the case of <code>zoo</code> objects -- number of
observations. In the case of seasonal time series, the results are all given
as decimal seasons of the year. In the case of dated observations, the
results can be dates, day of the year, or julian day with an origin of
1970-01-01, depending on the option <code>out</code>.</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p><code>phenoPhase</code> gives three measures of the phasing of a seasonal cycle:
the time of the maximum (Cloern and Jassby 2008), the <em>fulcrum</em> or
center of gravity, and the weighted mean season (Colebrook 1979). The latter
has sometimes been referred to in the literature as &#8220;centre of
gravity&#8221;, but it is not actually the same. These measures differ in their
sensitivity to changes in the seasonal pattern, and therefore also in their
susceptibility to sampling variability. The time of maximum is the most
sensitive, the weighted mean the least.</p>
<p>These measures can be restricted to a subset of the year by giving the
desired range of seasons. This can be useful for isolating measures of, say,
the spring and autumn phytoplankton blooms in temperate waters. In the case
of a seasonal time series, a non-missing value is required for every season
or the result will be <code>NA</code>, so using a period shorter than one year can
also help avoid any seasons that are typically not covered by the sampling
program. Similarly, in the case of dated observations, a shorter period can
help avoid times of sparse data. The method for time series allows for other
than monthly frequencies, but <code>season.range</code> is always interpreted as
months for <code>zoo</code> objects. The method for time series requires data for
all seasons in <code>season.range</code>. The method for <code>zoo</code> objects will
provide a result regardless of number of sampling days, so make sure that
data are sufficient for a meaningful result.</p>
<p>The measures are annum-centric, i.e., they reflect the use of calendar year
as the annum, which may not be appropriate for cases in which important
features occur in winter and span two calendar years. Such cases can be
handled by lagging the time series by an appropriate number of months, or by
subtracting an appropriate number of days from the individual dates.
    <code><a href='tsMake.html'>tsMake</a></code> can be used to produce <code>ts</code> and <code>zoo</code> objects
suitable as arguments to this function.</p>
<p>The default parameters used for the <code>integrate</code> function in
<code>phenoPhase</code> may fail for certain datasets. Try increasing the number
of subdivisions above its default of 100 by adding, for example,
<code>subdivisions = 1000</code> to the arguments of <code>phenoPhase</code>.</p>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Cloern, J.E. and Jassby, A.D. (2008) Complex seasonal patterns
of primary producers at the land-sea interface. <em>Ecology Letters</em>
<b>11,</b> 1294--1303.</p>
<p>Colebrook, J.M. (1979) Continuous plankton records - seasonal cycles of
phytoplankton and copepods in the North Atlantic ocean and the North Sea.
<em>Marine Biology</em> <b>51,</b> 23--32.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <p><code><a href='phenoAmp.html'>phenoAmp</a></code>, <code><a href='tsMake.html'>tsMake</a></code></p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'># ts example</span>
<span class='no'>y</span> <span class='kw'>&lt;-</span> <span class='no'>sfbayChla</span>[, <span class='st'>'s27'</span>]
<span class='no'>p1</span> <span class='kw'>&lt;-</span> <span class='fu'>phenoPhase</span>(<span class='no'>y</span>)
<span class='no'>p1</span></div><div class='output co'>#&gt;    year max.time fulcrum mean.wt
#&gt; 1  1978       NA      NA      NA
#&gt; 2  1979       NA      NA      NA
#&gt; 3  1980        4    4.52    5.54
#&gt; 4  1981       NA      NA      NA
#&gt; 5  1982       NA      NA      NA
#&gt; 6  1983       NA      NA      NA
#&gt; 7  1984       NA      NA      NA
#&gt; 8  1985       NA      NA      NA
#&gt; 9  1986       NA      NA      NA
#&gt; 10 1987        4    4.87    5.54
#&gt; 11 1988       NA      NA      NA
#&gt; 12 1989       NA      NA      NA
#&gt; 13 1990       NA      NA      NA
#&gt; 14 1991       NA      NA      NA
#&gt; 15 1992       NA      NA      NA
#&gt; 16 1993       NA      NA      NA
#&gt; 17 1994       NA      NA      NA
#&gt; 18 1995       NA      NA      NA
#&gt; 19 1996        4    4.24    5.43
#&gt; 20 1997       NA      NA      NA
#&gt; 21 1998       NA      NA      NA
#&gt; 22 1999       NA      NA      NA
#&gt; 23 2000       11   10.51    8.66
#&gt; 24 2001       NA      NA      NA
#&gt; 25 2002       NA      NA      NA
#&gt; 26 2003        2    3.15    4.29
#&gt; 27 2004        3    5.03    6.06
#&gt; 28 2005       NA      NA      NA
#&gt; 29 2006       NA      NA      NA
#&gt; 30 2007       NA      NA      NA
#&gt; 31 2008        4    4.55    5.39
#&gt; 32 2009       NA      NA      NA</div><div class='input'><span class='fu'>apply</span>(<span class='no'>p1</span>, <span class='fl'>2</span>, <span class='no'>sd</span>, <span class='kw'>na.rm</span><span class='kw'>=</span><span class='fl'>TRUE</span>)  <span class='co'># max.time &gt; fulcrum &gt; mean.wt</span></div><div class='output co'>#&gt;     year max.time  fulcrum  mean.wt 
#&gt; 9.380832 2.935821 2.391350 1.351158 </div><div class='input'><span class='fu'>phenoPhase</span>(<span class='no'>y</span>, <span class='fu'>c</span>(<span class='fl'>3</span>, <span class='fl'>10</span>))</div><div class='output co'>#&gt;    year max.time fulcrum mean.wt
#&gt; 1  1978       NA      NA      NA
#&gt; 2  1979        6    6.11    6.17
#&gt; 3  1980        4    4.56    5.33
#&gt; 4  1981       NA      NA      NA
#&gt; 5  1982       NA      NA      NA
#&gt; 6  1983        5    4.74    4.97
#&gt; 7  1984        4    4.71    5.55
#&gt; 8  1985       NA      NA      NA
#&gt; 9  1986       NA      NA      NA
#&gt; 10 1987        4    5.11    5.52
#&gt; 11 1988        4    5.48    5.80
#&gt; 12 1989        4    4.48    5.10
#&gt; 13 1990       NA      NA      NA
#&gt; 14 1991       NA      NA      NA
#&gt; 15 1992       NA      NA      NA
#&gt; 16 1993       NA      NA      NA
#&gt; 17 1994        3    5.28    5.15
#&gt; 18 1995        3    4.12    4.79
#&gt; 19 1996        4    4.28    4.96
#&gt; 20 1997        4    4.46    5.37
#&gt; 21 1998       NA      NA      NA
#&gt; 22 1999       NA      NA      NA
#&gt; 23 2000        4    4.40    5.16
#&gt; 24 2001       NA      NA      NA
#&gt; 25 2002       NA      NA      NA
#&gt; 26 2003        3    4.86    5.09
#&gt; 27 2004        3    5.78    5.77
#&gt; 28 2005       NA      NA      NA
#&gt; 29 2006       NA      NA      NA
#&gt; 30 2007       NA      NA      NA
#&gt; 31 2008        4    4.73    5.29
#&gt; 32 2009       NA      NA      NA</div><div class='input'>
<span class='co'># zoo example</span>
<span class='no'>sfb</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='wqData.html'>wqData</a></span>(<span class='no'>sfbay</span>, <span class='fu'>c</span>(<span class='fl'>1</span>,<span class='fl'>3</span>,<span class='fl'>4</span>), <span class='fl'>5</span>:<span class='fl'>12</span>, <span class='kw'>site.order</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"wide"</span>,
  <span class='kw'>time.format</span> <span class='kw'>=</span> <span class='st'>"%m/%d/%Y"</span>)
<span class='no'>y</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='tsMake.html'>tsMake</a></span>(<span class='no'>sfb</span>, <span class='kw'>focus</span> <span class='kw'>=</span> <span class='st'>'chl'</span>, <span class='kw'>layer</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='fl'>0</span>, <span class='fl'>5</span>), <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>'zoo'</span>)
<span class='fu'>phenoPhase</span>(<span class='no'>y</span>[, <span class='st'>'s27'</span>])</div><div class='output co'>#&gt;    year   max.time    fulcrum    mean.wt  n
#&gt; 1  1985 1985-03-29 1985-03-31 1985-04-19 17
#&gt; 2  1986 1986-04-29 1986-04-25 1986-04-27 21
#&gt; 3  1987 1987-04-16 1987-05-13 1987-05-18 20
#&gt; 4  1988 1988-04-14 1988-04-27 1988-06-09 16
#&gt; 5  1989 1989-03-01 1989-04-12 1989-04-12 25
#&gt; 6  1990 1990-04-12 1990-04-30 1990-04-21 13
#&gt; 7  1991 1991-04-11 1991-05-14 1991-04-22 18
#&gt; 8  1992 1992-04-14 1992-04-26 1992-04-25 21
#&gt; 9  1993 1993-03-25 1993-04-02 1993-04-04 17
#&gt; 10 1994 1994-03-04 1994-05-06 1994-04-20 20
#&gt; 11 1995 1995-03-30 1995-04-16 1995-04-11 22
#&gt; 12 1996 1996-04-03 1996-04-09 1996-04-21 21
#&gt; 13 1997 1997-02-19 1997-04-20 1997-04-06 20
#&gt; 14 1998 1998-04-09 1998-04-14 1998-04-10 23
#&gt; 15 1999 1999-03-24 1999-06-05 1999-06-04 13
#&gt; 16 2000 2000-11-09 2000-11-06 2000-07-26 16
#&gt; 17 2001 2001-04-16 2001-04-15 2001-04-27 16
#&gt; 18 2002 2002-03-12 2002-03-17 2002-05-21 13
#&gt; 19 2003 2003-02-24 2003-03-21 2003-04-03 21
#&gt; 20 2004 2004-03-24 2004-05-16 2004-05-22 18</div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#references">References</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Alan Jassby, Joseph Stachelek.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
